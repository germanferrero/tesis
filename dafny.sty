% dafny.sty
% Dafny mode for the LaTeX listings package.
% Rustan Leino, 22 June 2008.

\usepackage{listings}
\usepackage{xcolor}
\usepackage{hyperref}
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{dafny}[2008/06/22 Dafny mode for listings]

\definecolor{codeyellow}{RGB}{220,220,170}
\definecolor{codeblue}{RGB}{84,114,214}
\definecolor{codepurple}{RGB}{88,24,69}
\definecolor{black}{RGB}{31,31,31}

\lstdefinelanguage{dafny}{
  morekeywords = {method,returns,requires,ensures,int,nat,while,decreases,invariant,if,else, lemma, axiom, function, forall, exists, assert, assume, var, predicate, ghost, return},
  xleftmargin=0pt,            % Remove left margin
  xrightmargin=0pt,           % Remove right margin
  aboveskip=0pt,              % Remove space above the listing
  belowskip=0pt,              % Remove space below the listing
  columns=fullflexible,       % Ensure no extra spacing
  numbers=left,
  numberstyle=\small\color{black}\ttfamily,
  firstnumber=1,
  stepnumber=1,
  backgroundcolor=\color{white},
  keywordstyle=\color{codepurple},
  basicstyle=\color{black}\ttfamily,
  sensitive=true,
  morecomment=[l]{//},
  morecomment=[s]{/*}{*/},
  morestring=[b]",
  commentstyle=\itshape
  }
  
\lstnewenvironment{dafny}[1][]{%
  \lstset{
    language=dafny,
    #1}
}{}

\def\inlinedafny{%
  \lstinline[language=dafny,basicstyle=\ttfamily,columns=fixed]
}

\newcommand{\dafnyfile}[2]{
  \lstinputlisting[
    language=dafny,
    caption=\href{https://github.com/germanferrero/tesis/tree/main/#2}{\texttt{#1}},
    captionpos=b,
    basicstyle=\color{white}\ttfamily,
    frame=lines,
    xleftmargin=2em,
    xrightmargin=8pt,
    columns=fixed,
    breaklines=true]{#2}
}
